<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>SISI 6259</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            /* PHOTO COFFEE SHOP EN ARRI√àRE-PLAN */
            background: 
                linear-gradient(135deg, rgba(102, 126, 234, 0.85) 0%, rgba(118, 75, 162, 0.85) 50%, rgba(240, 147, 251, 0.85) 100%),
                url('/coffeeshop.jpg') center/cover no-repeat fixed;
            color: #2d3748;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* DRAPEAUX FLOTTANTS (plus discrets) */
        .floating-flags {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .flag {
            position: absolute;
            width: 100px;
            height: 70px;
            background-size: cover;
            background-position: center;
            opacity: 0.3;
            filter: drop-shadow(0 4px 12px rgba(0,0,0,0.4));
            animation: float 20s infinite ease-in-out;
            border-radius: 10px;
            border: 3px solid rgba(255,255,255,0.4);
        }

        .flag.usa {
            background: linear-gradient(to bottom,
                #B22234 0%, #B22234 7.7%,
                white 7.7%, white 15.4%,
                #B22234 15.4%, #B22234 23.1%,
                white 23.1%, white 30.8%,
                #B22234 30.8%, #B22234 38.5%,
                white 38.5%, white 46.2%,
                #B22234 46.2%, #B22234 53.9%,
                white 53.9%, white 61.6%,
                #B22234 61.6%, #B22234 69.3%,
                white 69.3%, white 77%,
                #B22234 77%, #B22234 84.7%,
                white 84.7%, white 92.4%,
                #B22234 92.4%, #B22234 100%);
            position: relative;
        }

        .flag.usa::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 40%;
            height: 50%;
            background: #3C3B6E;
        }

        .flag.nl {
            background: linear-gradient(to bottom,
                #AE1C28 0%, #AE1C28 33.33%,
                white 33.33%, white 66.66%,
                #21468B 66.66%, #21468B 100%);
        }

        .flag.ma {
            background: #C1272D;
            position: relative;
        }

        .flag.ma::after {
            content: '‚òÖ';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 35px;
            color: #006233;
        }

        .flag:nth-child(1) { left: 8%; top: 15%; animation-duration: 25s; animation-delay: 0s; }
        .flag:nth-child(2) { left: 75%; top: 8%; animation-duration: 30s; animation-delay: 2s; }
        .flag:nth-child(3) { left: 25%; top: 65%; animation-duration: 22s; animation-delay: 4s; }
        .flag:nth-child(4) { left: 85%; top: 75%; animation-duration: 28s; animation-delay: 1s; }
        .flag:nth-child(5) { left: 45%; top: 35%; animation-duration: 26s; animation-delay: 3s; }
        .flag:nth-child(6) { left: 12%; top: 85%; animation-duration: 24s; animation-delay: 5s; }
        .flag:nth-child(7) { left: 92%; top: 40%; animation-duration: 27s; animation-delay: 6s; }
        .flag:nth-child(8) { left: 35%; top: 10%; animation-duration: 23s; animation-delay: 7s; }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(-3deg) scale(1); }
            25% { transform: translateY(-40px) rotate(3deg) scale(1.08); }
            50% { transform: translateY(-60px) rotate(-3deg) scale(1.12); }
            75% { transform: translateY(-40px) rotate(3deg) scale(1.08); }
        }

        .bg-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.05), transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.05), transparent 40%);
            pointer-events: none;
            z-index: 1;
        }

        .music-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            z-index: 1000;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .music-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.6);
        }

        .music-btn.playing {
            animation: pulse-music 2s infinite;
        }

        @keyframes pulse-music {
            0%, 100% { box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4); }
            50% { box-shadow: 0 8px 40px rgba(102, 126, 234, 0.8); }
        }

        .content {
            position: relative;
            z-index: 2;
            padding: 25px;
            padding-bottom: 100px;
            max-width: 1300px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 45px;
            padding: 45px 35px;
            background: transparent;
            backdrop-filter: none;
            border-radius: 35px;
            box-shadow: none;
            animation: headerFadeIn 0.8s ease;
        }

        @keyframes headerFadeIn {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 25px;
            position: relative;
        }

        .logo-glow {
            position: absolute;
            width: 220px;
            height: 220px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            opacity: 0.3;
            filter: blur(30px);
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.1); opacity: 0.5; }
        }

        .logo {
            position: relative;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            object-fit: cover;
            border: 6px solid #fff;
            box-shadow: 0 20px 60px rgba(102, 126, 234, 0.4);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .logo:hover {
            transform: scale(1.08) translateY(-8px) rotate(5deg);
            box-shadow: 0 30px 80px rgba(102, 126, 234, 0.5);
        }

        .header-title {
            font-size: 22px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 1px;
            margin-top: 20px;
        }

        .admin-btn {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 14px 32px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 50px;
            color: white;
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            z-index: 100;
        }

        .admin-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.6);
        }

        .admin-btn.active {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            box-shadow: 0 8px 25px rgba(245, 87, 108, 0.4);
        }

        .filter-container {
            margin-bottom: 35px;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            padding: 15px 0;
        }

        .filter-btn {
            padding: 16px 36px;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            border: 2px solid transparent;
            border-radius: 50px;
            color: #4a5568;
            font-family: 'Poppins', sans-serif;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .filter-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .filter-btn.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: transparent;
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.5);
            transform: translateY(-3px) scale(1.05);
        }

        .gallery-view.hidden {
            display: none;
        }

        /* PAGE INFO */
        .info-page {
            max-width: 900px;
            margin: 0 auto;
        }

        .info-section {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 35px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.5);
            animation: cardFadeIn 0.6s ease;
        }

        @keyframes cardFadeIn {
            from { opacity: 0; transform: translateY(30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .info-title {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .info-title .icon {
            font-size: 28px;
        }

        /* Service Cards */
        .service-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .service-card {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid rgba(102, 126, 234, 0.2);
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
            border-color: rgba(102, 126, 234, 0.4);
        }

        .service-icon {
            font-size: 50px;
            margin-bottom: 15px;
        }

        .service-name {
            font-size: 20px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .service-desc {
            font-size: 14px;
            color: #718096;
            line-height: 1.6;
        }

        /* Features Grid */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 20px;
        }

        .feature-box {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 20px;
            padding: 30px 20px;
            text-align: center;
            color: white;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .feature-box:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.5);
        }

        .feature-icon {
            font-size: 40px;
            margin-bottom: 12px;
        }

        .feature-text {
            font-size: 15px;
            font-weight: 600;
            line-height: 1.4;
        }

        /* Horaires Cards */
        .horaires-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
        }

        .horaire-card {
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.1), rgba(0, 242, 254, 0.1));
            border: 2px solid rgba(79, 172, 254, 0.3);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .horaire-card:hover {
            transform: translateY(-5px);
            border-color: rgba(79, 172, 254, 0.6);
            box-shadow: 0 10px 30px rgba(79, 172, 254, 0.2);
        }

        .horaire-icon {
            font-size: 45px;
            margin-bottom: 15px;
        }

        .horaire-label {
            font-size: 14px;
            color: #718096;
            font-weight: 600;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .horaire-time {
            font-size: 28px;
            font-weight: 800;
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Payment Info */
        .payment-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .payment-item {
            background: linear-gradient(135deg, rgba(168, 224, 99, 0.1), rgba(86, 171, 47, 0.1));
            border: 2px solid rgba(86, 171, 47, 0.3);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }

        .payment-item:hover {
            border-color: rgba(86, 171, 47, 0.6);
            transform: translateX(5px);
            box-shadow: 0 5px 20px rgba(86, 171, 47, 0.2);
        }

        .payment-icon {
            font-size: 28px;
            flex-shrink: 0;
        }

        .payment-text {
            font-size: 15px;
            color: #2d3748;
            font-weight: 500;
            line-height: 1.5;
        }

        /* Zones Section avec Drapeaux SVG */
        .zones-list {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }

        .zone-badge {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255, 255, 255, 0.95);
            border: 3px solid;
            border-radius: 50px;
            padding: 20px 40px;
            font-size: 20px;
            font-weight: 700;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
        }

        .zone-badge.france {
            border-color: #0055A4;
            color: #0055A4;
        }

        .zone-badge.belgique {
            border-color: #FDDA24;
            color: #2d3748;
            background: linear-gradient(135deg, rgba(253, 218, 36, 0.1), rgba(239, 65, 35, 0.1));
        }

        .zone-badge:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.25);
        }

        .flag-svg {
            vertical-align: middle;
            transition: transform 0.3s ease;
        }

        .flag-svg:hover {
            transform: scale(1.1);
        }

        .zone-badge .flag-svg {
            width: 60px;
            height: 45px;
        }

        /* CARTE CONTACT SNAPCHAT */
        .contact-cards {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .contact-card {
            background: linear-gradient(135deg, #FFFC00, #FFF566);
            border-radius: 25px;
            padding: 45px 40px;
            text-align: center;
            text-decoration: none;
            color: #000;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 30px rgba(255, 252, 0, 0.3);
            border: 3px solid #FFFC00;
            cursor: pointer;
            min-width: 300px;
            max-width: 400px;
            position: relative;
            overflow: hidden;
            display: block;
        }

        .contact-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
            transition: left 0.6s;
        }

        .contact-card:hover::before {
            left: 100%;
        }

        .contact-card:hover {
            transform: translateY(-12px) scale(1.05);
            box-shadow: 0 20px 50px rgba(255, 252, 0, 0.6);
            border-color: #FFD700;
        }

        .contact-icon {
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            animation: bounceIcon 2s ease-in-out infinite;
            color: #000;
        }

        @keyframes bounceIcon {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-12px); }
        }

        .contact-name {
            font-size: 28px;
            font-weight: 800;
            color: #000;
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }

        .contact-username {
            font-size: 20px;
            font-weight: 700;
            color: #222;
            margin-bottom: 18px;
        }

        .contact-cta {
            font-size: 15px;
            font-weight: 600;
            color: #333;
            padding: 12px 24px;
            background: rgba(0, 0, 0, 0.15);
            border-radius: 50px;
            display: inline-block;
            transition: all 0.3s ease;
        }

        .contact-card:hover .contact-cta {
            background: rgba(0, 0, 0, 0.25);
            transform: scale(1.05);
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            animation: cardFadeIn 0.6s ease;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .card:hover {
            transform: translateY(-12px) scale(1.02);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.25);
        }

        .card-media-container {
            position: relative;
            width: 100%;
            height: 240px;
            overflow: hidden;
            background: linear-gradient(135deg, #f5f7fa, #e9ecef);
        }

        .card-media {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card:hover .card-media {
            transform: scale(1.15);
        }

        .card-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60%;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.7), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .card:hover .card-overlay {
            opacity: 1;
        }

        .card-content {
            padding: 25px;
        }

        .card-category {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 18px;
            border-radius: 50px;
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 15px;
        }

        .card-category.article {
            background: linear-gradient(135deg, #a8e063, #56ab2f);
            color: white;
            box-shadow: 0 4px 15px rgba(86, 171, 47, 0.3);
        }

        .card-title {
            font-size: 21px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 12px;
            line-height: 1.3;
        }

        .card-description {
            font-size: 14px;
            color: #718096;
            line-height: 1.7;
        }

        .video-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 75px;
            height: 75px;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: #667eea;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.25);
            transition: all 0.3s ease;
        }

        .card:hover .video-icon {
            transform: translate(-50%, -50%) scale(1.15);
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .empty-state {
            text-align: center;
            padding: 100px 30px;
            grid-column: 1 / -1;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
        }

        .empty-icon {
            font-size: 90px;
            margin-bottom: 25px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 26px;
            margin-bottom: 12px;
            color: #2d3748;
            font-weight: 700;
        }

        .empty-state p {
            color: #718096;
            font-size: 16px;
        }

        .admin-view {
            display: none;
        }

        .admin-view.active {
            display: block;
            animation: fadeIn 0.6s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .flag {
                width: 70px;
                height: 50px;
            }

            .logo {
                width: 170px;
                height: 170px;
            }

            .logo-glow {
                width: 190px;
                height: 190px;
            }

            .cards-grid {
                grid-template-columns: 1fr;
            }

            .filter-container {
                flex-direction: column;
            }

            .filter-btn {
                width: 100%;
            }

            .admin-btn {
                top: 15px;
                right: 15px;
                padding: 12px 24px;
                font-size: 13px;
            }

            .music-btn {
                width: 50px;
                height: 50px;
                font-size: 20px;
                bottom: 20px;
                right: 20px;
            }

            .info-section {
                padding: 25px;
            }

            .service-cards {
                grid-template-columns: 1fr;
            }

            .features-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .horaires-cards {
                grid-template-columns: 1fr;
            }

            .zone-badge {
                padding: 18px 30px;
                font-size: 18px;
            }

            .zone-badge .flag-svg {
                width: 48px;
                height: 36px;
            }

            .contact-card {
                min-width: 100%;
                max-width: 100%;
                padding: 40px 30px;
            }

            .contact-icon svg {
                width: 70px;
                height: 70px;
            }

            .contact-name {
                font-size: 24px;
            }

            .contact-username {
                font-size: 18px;
            }
        }

        /* ===== LOGIN ADMIN ===== */
        .admin-login-page { max-width: 450px; margin: 0 auto; padding: 20px 0; }
        .login-card { background: rgba(255,255,255,0.98); border-radius: 30px; padding: 50px 40px; box-shadow: 0 20px 60px rgba(0,0,0,0.2); text-align: center; }
        .login-icon { font-size: 64px; margin-bottom: 20px; display: block; }
        .login-title { font-size: 26px; font-weight: 800; color: #2d3748; margin-bottom: 8px; }
        .login-subtitle { font-size: 14px; color: #718096; margin-bottom: 35px; }
        .login-form { display: flex; flex-direction: column; gap: 18px; }
        .input-group { position: relative; text-align: left; }
        .input-group label { display: block; font-size: 13px; font-weight: 600; color: #4a5568; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px; }
        .input-group input { width: 100%; padding: 16px 52px 16px 20px; border: 2px solid #e2e8f0; border-radius: 15px; font-family: 'Poppins', sans-serif; font-size: 15px; color: #2d3748; background: #f7fafc; outline: none; transition: all 0.3s ease; }
        .input-group input:focus { border-color: #667eea; background: white; box-shadow: 0 0 0 4px rgba(102,126,234,0.15); }
        .input-icon { position: absolute; right: 18px; bottom: 18px; font-size: 18px; pointer-events: none; }
        .toggle-pw { position: absolute; right: 18px; bottom: 16px; font-size: 18px; cursor: pointer; background: none; border: none; padding: 0; line-height: 1; }
        .login-btn { margin-top: 5px; padding: 18px; background: linear-gradient(135deg, #667eea, #764ba2); border: none; border-radius: 15px; color: white; font-family: 'Poppins', sans-serif; font-size: 16px; font-weight: 700; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 8px 25px rgba(102,126,234,0.4); }
        .login-btn:hover { transform: translateY(-3px); box-shadow: 0 12px 35px rgba(102,126,234,0.6); }
        .login-error { display: none; background: rgba(245,87,108,0.12); border: 2px solid rgba(245,87,108,0.4); color: #c53030; border-radius: 12px; padding: 14px 18px; font-size: 14px; font-weight: 500; }
        @keyframes shake { 0%,100% { transform: translateX(0); } 20%,60% { transform: translateX(-8px); } 40%,80% { transform: translateX(8px); } }

        /* ===== PANEL ADMIN ===== */
        .admin-panel { display: none; }
        .admin-panel.active { display: block; animation: fadeIn 0.5s ease; }
        .admin-header-bar { background: rgba(255,255,255,0.98); border-radius: 20px; padding: 20px 30px; margin-bottom: 25px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
        .admin-welcome { font-size: 18px; font-weight: 700; color: #2d3748; }
        .admin-welcome span { background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .logout-btn { padding: 10px 22px; background: linear-gradient(135deg, #f093fb, #f5576c); border: none; border-radius: 50px; color: white; font-family: 'Poppins', sans-serif; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .logout-btn:hover { transform: translateY(-2px); }
        .admin-form { background: rgba(255,255,255,0.98); border-radius: 25px; padding: 40px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); margin-bottom: 25px; }
        .admin-form h3 { font-size: 22px; font-weight: 700; color: #2d3748; margin-bottom: 30px; display: flex; align-items: center; gap: 10px; }
        .form-row { margin-bottom: 20px; }
        .form-row label { display: block; font-size: 13px; font-weight: 600; color: #4a5568; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px; }
        .form-row input[type="text"], .form-row textarea, .form-row select { width: 100%; padding: 14px 18px; border: 2px solid #e2e8f0; border-radius: 12px; font-family: 'Poppins', sans-serif; font-size: 14px; color: #2d3748; background: #f7fafc; outline: none; transition: all 0.3s ease; }
        .form-row input[type="text"]:focus, .form-row textarea:focus, .form-row select:focus { border-color: #667eea; background: white; box-shadow: 0 0 0 4px rgba(102,126,234,0.15); }
        .form-row textarea { resize: vertical; min-height: 90px; }
        .upload-tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .upload-tab { flex: 1; padding: 12px; border: 2px solid #e2e8f0; border-radius: 12px; background: #f7fafc; font-family: 'Poppins', sans-serif; font-size: 14px; font-weight: 600; color: #718096; cursor: pointer; transition: all 0.3s ease; text-align: center; }
        .upload-tab.active { border-color: #667eea; background: linear-gradient(135deg, #667eea, #764ba2); color: white; }
        .upload-zone { border: 3px dashed #cbd5e0; border-radius: 20px; padding: 40px 20px; text-align: center; cursor: pointer; transition: all 0.3s ease; background: #f7fafc; position: relative; overflow: hidden; }
        .upload-zone:hover { border-color: #667eea; background: rgba(102,126,234,0.05); }
        .upload-zone input[type="file"] { position: absolute; inset: 0; opacity: 0; cursor: pointer; width: 100%; height: 100%; }
        .upload-icon { font-size: 48px; margin-bottom: 12px; }
        .upload-text { font-size: 15px; font-weight: 600; color: #4a5568; margin-bottom: 6px; }
        .upload-sub { font-size: 13px; color: #a0aec0; }
        .media-preview { display: none; margin-top: 15px; border-radius: 15px; overflow: hidden; max-height: 300px; position: relative; background: #000; }
        .media-preview.show { display: block; }
        .media-preview img, .media-preview video { width: 100%; max-height: 300px; object-fit: contain; display: block; }
        .preview-remove { position: absolute; top: 10px; right: 10px; background: rgba(245,87,108,0.85); border: none; border-radius: 50%; width: 34px; height: 34px; color: white; font-size: 16px; cursor: pointer; display: flex; align-items: center; justify-content: center; z-index: 5; }
        .preview-info { background: rgba(0,0,0,0.6); color: white; font-size: 12px; padding: 6px 12px; text-align: center; }
        .upload-progress { display: none; margin-top: 15px; }
        .upload-progress.show { display: block; }
        .progress-bar-wrap { background: #e2e8f0; border-radius: 50px; height: 10px; overflow: hidden; }
        .progress-bar-fill { height: 100%; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 50px; transition: width 0.3s ease; width: 0%; }
        .progress-label { font-size: 13px; color: #718096; text-align: center; margin-top: 8px; }
        .admin-gallery { background: rgba(255,255,255,0.98); border-radius: 25px; padding: 40px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
        .admin-gallery h3 { font-size: 22px; font-weight: 700; color: #2d3748; margin-bottom: 25px; display: flex; align-items: center; gap: 10px; }
        .admin-cards-list { display: flex; flex-direction: column; gap: 15px; }
        .admin-card-item { display: flex; align-items: center; gap: 18px; background: #f7fafc; border-radius: 15px; padding: 15px 20px; border: 2px solid #e2e8f0; }
        .admin-card-item:hover { border-color: #667eea; }
        .admin-card-thumb { width: 70px; height: 55px; border-radius: 10px; object-fit: cover; flex-shrink: 0; background: #edf2f7; }
        .admin-card-info { flex: 1; min-width: 0; }
        .admin-card-name { font-size: 15px; font-weight: 700; color: #2d3748; margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .admin-card-cat { font-size: 12px; color: #718096; }
        .delete-btn { padding: 8px 16px; background: linear-gradient(135deg, #f093fb, #f5576c); border: none; border-radius: 50px; color: white; font-size: 13px; font-weight: 600; cursor: pointer; flex-shrink: 0; font-family: 'Poppins', sans-serif; }
        .submit-btn { padding: 16px; background: linear-gradient(135deg, #667eea, #764ba2); border: none; border-radius: 15px; color: white; font-family: 'Poppins', sans-serif; font-size: 15px; font-weight: 700; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 8px 25px rgba(102,126,234,0.4); width: 100%; margin-top: 10px; }
        .submit-btn:hover { transform: translateY(-3px); }
        .submit-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }

        /* ===== MODAL CARTE ===== */
        .card { cursor: pointer; }
        .card-modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.88); z-index: 9999; align-items: center; justify-content: center; padding: 20px; backdrop-filter: blur(8px); }
        .card-modal-overlay.open { display: flex; }
        .card-modal { background: white; border-radius: 30px; max-width: 640px; width: 100%; max-height: 92vh; overflow-y: auto; box-shadow: 0 30px 80px rgba(0,0,0,0.4); animation: modalPop 0.35s cubic-bezier(0.34,1.56,0.64,1); position: relative; }
        @keyframes modalPop { from { transform: scale(0.75); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .modal-close { position: absolute; top: 14px; right: 14px; width: 38px; height: 38px; background: rgba(0,0,0,0.45); border: none; border-radius: 50%; color: white; font-size: 18px; cursor: pointer; z-index: 10; display: flex; align-items: center; justify-content: center; transition: all 0.2s ease; }
        .modal-close:hover { background: rgba(245,87,108,0.85); transform: scale(1.1); }
        .modal-media { width: 100%; max-height: 400px; object-fit: cover; border-radius: 30px 30px 0 0; display: block; }
        .modal-body { padding: 28px 32px 34px; }
        .modal-category { display: inline-flex; align-items: center; gap: 6px; padding: 8px 18px; border-radius: 50px; font-size: 13px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 14px; background: linear-gradient(135deg, #a8e063, #56ab2f); color: white; }
        .modal-title { font-size: 24px; font-weight: 800; color: #2d3748; margin-bottom: 12px; line-height: 1.3; }
        .modal-desc { font-size: 15px; color: #718096; line-height: 1.8; }

        @media (max-width: 768px) {
            .upload-tabs { flex-direction: column; }
            .admin-form, .admin-gallery { padding: 25px; }
            .modal-body { padding: 20px 22px 28px; }
        }

    </style>
</head>
<body>
    <!-- DRAPEAUX FLOTTANTS -->
    <div class="floating-flags">
        <div class="flag usa"></div>
        <div class="flag nl"></div>
        <div class="flag ma"></div>
        <div class="flag usa"></div>
        <div class="flag nl"></div>
        <div class="flag ma"></div>
        <div class="flag usa"></div>
        <div class="flag nl"></div>
    </div>

    <div class="bg-overlay"></div>

    <button class="music-btn" id="musicBtn" onclick="toggleMusic()">üéµ</button>
    <audio id="bgMusic" loop>
        <source src="/music.mp3" type="audio/mpeg">
    </audio>

    <div class="content">
        
    <!-- MODALE CARTE -->
    <div class="card-modal-overlay" id="cardModal" onclick="closeModalBg(event)">
        <div class="card-modal">
            <button class="modal-close" onclick="closeCardModal()">‚úï</button>
            <div id="modalContent"></div>
        </div>
    </div>

        <button class="admin-btn" id="adminToggle" onclick="toggleAdmin()">üîê Admin</button>

        <div class="header">
            <div class="logo-container">
                <div class="logo-glow"></div>
                <img src="/logo.png" alt="SISI 6259" class="logo" onerror="this.src='https://via.placeholder.com/200/667eea/FFFFFF?text=SISI+6259'">
            </div>
            <p class="header-title" id="headerTitle">MA GALERIE</p>
        </div>

        <div class="gallery-view" id="galleryView">
            <div class="filter-container">
                <button class="filter-btn active" data-filter="Article">üìù Article</button>
                <button class="filter-btn" data-filter="Info">‚ÑπÔ∏è Info</button>
                <button class="filter-btn" data-filter="Contact">üìû Contact</button>
            </div>

            <div class="cards-grid" id="gallery"></div>

            <!-- PAGE INFO -->
            <div class="info-page" id="infoPage" style="display: none;">
                <div class="info-section">
                    <h2 class="info-title">
                        <span class="icon">üìç</span> Nos Services
                    </h2>

                    <div class="service-cards">
                        <div class="service-card">
                            <div class="service-icon">üìç</div>
                            <div class="service-name">Meet-Up</div>
                            <div class="service-desc">Plusieurs Meet-Up √† votre disposition<br><br>En priv√© pour + d'informations...</div>
                        </div>

                        <div class="service-card">
                            <div class="service-icon">üöö</div>
                            <div class="service-name">Livraison</div>
                            <div class="service-desc">Livraison disponible dans les<br><strong>59 / 62</strong> <svg class="flag-svg" width="35" height="26" viewBox="0 0 900 600" style="border-radius: 4px; box-shadow: 0 2px 6px rgba(0,0,0,0.2); vertical-align: middle;"><rect width="300" height="600" fill="#002395"/><rect x="300" width="300" height="600" fill="#FFFFFF"/><rect x="600" width="300" height="600" fill="#ED2939"/></svg><br>et <strong>Belgique 02 / 80</strong> <svg class="flag-svg" width="35" height="26" viewBox="0 0 900 600" style="border-radius: 4px; box-shadow: 0 2px 6px rgba(0,0,0,0.2); vertical-align: middle;"><rect width="300" height="600" fill="#000000"/><rect x="300" width="300" height="600" fill="#FDDA24"/><rect x="600" width="300" height="600" fill="#EF3340"/></svg></div>
                        </div>
                    </div>
                </div>

                <div class="info-section">
                    <h2 class="info-title">
                        <span class="icon">‚ö°</span> Pourquoi nous choisir ?
                    </h2>

                    <div class="features-grid">
                        <div class="feature-box">
                            <div class="feature-icon">üîí</div>
                            <div class="feature-text">Discr√©tion<br>garantie</div>
                        </div>

                        <div class="feature-box">
                            <div class="feature-icon">‚ö°</div>
                            <div class="feature-text">Livraison<br>rapide</div>
                        </div>

                        <div class="feature-box">
                            <div class="feature-icon">üíé</div>
                            <div class="feature-text">Qualit√©<br>premium</div>
                        </div>

                        <div class="feature-box">
                            <div class="feature-icon">üéØ</div>
                            <div class="feature-text">Service<br>24/7</div>
                        </div>
                    </div>
                </div>

                <div class="info-section">
                    <h2 class="info-title">
                        <span class="icon">üïê</span> Horaires
                    </h2>

                    <div class="horaires-cards">
                        <div class="horaire-card">
                            <div class="horaire-icon">üöö</div>
                            <div class="horaire-label">Horaire livraisons</div>
                            <div class="horaire-time">13h - 00h</div>
                        </div>

                        <div class="horaire-card">
                            <div class="horaire-icon">üìç</div>
                            <div class="horaire-label">Horaire sur place</div>
                            <div class="horaire-time">12h - 01h</div>
                        </div>
                    </div>
                </div>

                <div class="info-section">
                    <h2 class="info-title">
                        <span class="icon">üì¶</span> Pour un traitement rapide
                    </h2>

                    <div class="payment-info">
                        <div class="payment-item">
                            <span class="payment-icon">‚úÖ</span>
                            <span class="payment-text">V√©rification d'identit√© (nouveaux clients)</span>
                        </div>

                        <div class="payment-item">
                            <span class="payment-icon">üí≥</span>
                            <span class="payment-text">Modes de paiement : <strong>CASH, BTC, Virement...</strong></span>
                        </div>
                    </div>
                </div>

                <div class="info-section">
                    <h2 class="info-title">
                        <span class="icon">üó∫Ô∏è</span> Zones de livraison
                    </h2>

                    <div class="zones-list">
                        <div class="zone-badge france">
                            <svg class="flag-svg" width="60" height="45" viewBox="0 0 900 600" style="border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">
                                <rect width="300" height="600" fill="#002395"/>
                                <rect x="300" width="300" height="600" fill="#FFFFFF"/>
                                <rect x="600" width="300" height="600" fill="#ED2939"/>
                            </svg>
                            <span class="zone-text">59 / 62</span>
                        </div>

                        <div class="zone-badge belgique">
                            <svg class="flag-svg" width="60" height="45" viewBox="0 0 900 600" style="border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">
                                <rect width="300" height="600" fill="#000000"/>
                                <rect x="300" width="300" height="600" fill="#FDDA24"/>
                                <rect x="600" width="300" height="600" fill="#EF3340"/>
                            </svg>
                            <span class="zone-text">Belgique 02 / 80</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PAGE CONTACT -->
            <div class="info-page" id="contactPage" style="display: none;">
                <div class="info-section">
                    <h2 class="info-title">
                        <span class="icon">üìû</span> Nous Contacter
                    </h2>

                    <div class="contact-cards">
                        <a href="https://www.snapchat.com/add/sisi62259" target="_blank" class="contact-card">
                            <div class="contact-icon">
                                <svg width="80" height="80" viewBox="0 0 512 512" fill="currentColor">
                                    <path d="M496.926,366.6c-3.373-9.176-9.8-14.086-17.112-18.153-1.376-.806-2.641-1.451-3.72-1.947-2.182-1.128-4.414-2.22-6.634-3.305-22.181-10.832-40.627-19.828-43.759-32.047a13.518,13.518,0,0,1,.255-8.128,74.407,74.407,0,0,0,5.069-18.166c15.118-1.3,24.145-9.53,26.816-24.456,1.806-10.081.165-18.693-4.613-24.205a26.158,26.158,0,0,0-6.994-5.458,68.226,68.226,0,0,0,.662-9.966c.018-2.964-.054-6.012-.217-9.053-.859-15.926-5.217-31.337-12.946-45.806C407.271,132.5,372.187,116.1,333.2,116.1h-1.958c-42.088-.239-77.237,17.07-104.545,51.477-7.728,14.469-12.087,29.88-12.946,45.807-.163,3.04-.235,6.088-.217,9.052a68.229,68.229,0,0,0,.662,9.967,26.162,26.162,0,0,0-6.995,5.458c-4.777,5.512-6.419,14.124-4.613,24.205,2.671,14.926,11.7,23.151,26.816,24.456a74.41,74.41,0,0,0,5.069,18.166,13.518,13.518,0,0,1,.255,8.128c-3.132,12.219-21.578,21.215-43.759,32.047-2.22,1.085-4.452,2.177-6.634,3.305-1.079.5-2.344,1.141-3.72,1.947-7.308,4.067-13.739,8.977-17.112,18.153-3.671,9.984-3.462,20.58.6,30.658,4.252,10.547,11.4,17.58,20.679,20.345,10.477,3.124,21.44,2.715,32.643-.126a151.446,151.446,0,0,0,33.542-11.556c3.1-1.495,6.1-2.965,9.028-4.428a83.762,83.762,0,0,1,10.131,16.021,66.678,66.678,0,0,0,18.4,21.267c11.535,8.329,25.462,12.551,41.4,12.551s29.862-4.222,41.4-12.551a66.668,66.668,0,0,0,18.4-21.267,83.746,83.746,0,0,1,10.131-16.021c2.928,1.463,5.929,2.933,9.028,4.428a151.461,151.461,0,0,0,33.542,11.556c11.2,2.841,22.166,3.25,32.643.126,9.276-2.765,16.427-9.8,20.679-20.345C500.388,387.176,500.6,376.58,496.926,366.6Z"/>
                                </svg>
                            </div>
                            <div class="contact-name">Snapchat</div>
                            <div class="contact-username">@sisi62259</div>
                            <div class="contact-cta">üëÜ Cliquez pour nous ajouter</div>
                        </a>
                    </div>
                </div>
            </div>
        </div>

                <div class="admin-view" id="adminView">

            <!-- LOGIN -->
            <div class="admin-login-page" id="adminLoginPage">
                <div class="login-card">
                    <span class="login-icon">üîê</span>
                    <h2 class="login-title">Panel Admin</h2>
                    <p class="login-subtitle">Entrez vos identifiants pour continuer</p>
                    <div class="login-form">
                        <div class="input-group">
                            <label>Nom d'utilisateur</label>
                            <input type="text" id="adminUsername" placeholder="Nom d'utilisateur" autocomplete="off">
                            <span class="input-icon">üë§</span>
                        </div>
                        <div class="input-group">
                            <label>Mot de passe</label>
                            <input type="password" id="adminPassword" placeholder="Mot de passe" autocomplete="off"
                                onkeydown="if(event.key==='Enter')doLogin()">
                            <button class="toggle-pw" onclick="togglePw()" type="button">üëÅÔ∏è</button>
                        </div>
                        <div class="login-error" id="loginError">‚ùå Identifiants incorrects</div>
                        <button class="login-btn" onclick="doLogin()">üöÄ Se connecter</button>
                    </div>
                </div>
            </div>

            <!-- PANEL -->
            <div class="admin-panel" id="adminPanel">
                <div class="admin-header-bar">
                    <div class="admin-welcome">üëã Bienvenue, <span id="loggedUser">Admin</span></div>
                    <button class="logout-btn" onclick="doLogout()">üö™ D√©connexion</button>
                </div>

                <div class="admin-form">
                    <h3>‚ûï Ajouter un m√©dia</h3>

                    <div class="upload-tabs">
                        <div class="upload-tab active" id="tabFile" onclick="switchTab('file')">üì± Depuis mon t√©l√©phone</div>
                        <div class="upload-tab" id="tabUrl" onclick="switchTab('url')">üîó Depuis une URL</div>
                    </div>

                    <div id="sectionFile">
                        <div class="upload-zone" id="uploadZone">
                            <input type="file" id="fileInput" accept="image/*,video/*" onchange="handleFileSelect(event)">
                            <div class="upload-icon" id="uploadIcon">üì∏</div>
                            <div class="upload-text">Appuyez pour choisir</div>
                            <div class="upload-sub">Photo ou vid√©o ¬∑ JPG PNG GIF MP4 MOV</div>
                        </div>
                        <div class="media-preview" id="mediaPreview">
                            <button class="preview-remove" onclick="removeFile()" type="button">‚úï</button>
                            <img id="previewImg" src="" alt="" style="display:none">
                            <video id="previewVid" src="" controls playsinline style="display:none"></video>
                            <div class="preview-info" id="previewInfo"></div>
                        </div>
                        <div class="upload-progress" id="uploadProgress">
                            <div class="progress-bar-wrap"><div class="progress-bar-fill" id="progressFill"></div></div>
                            <div class="progress-label" id="progressLabel">Envoi en cours...</div>
                        </div>
                    </div>

                    <div id="sectionUrl" style="display:none">
                        <div class="form-row" style="margin-bottom:0">
                            <label>URL directe de l'image ou vid√©o</label>
                            <input type="text" id="mediaUrl" placeholder="https://exemple.com/photo.jpg">
                        </div>
                    </div>

                    <div style="margin-top:22px">
                        <div class="form-row">
                            <label>Nom</label>
                            <input type="text" id="mediaName" placeholder="Ex: Arrivage du jour...">
                        </div>
                        <div class="form-row">
                            <label>Cat√©gorie</label>
                            <select id="mediaCategory">
                                <option value="Article">üìù Article</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <label>Description (optionnel)</label>
                            <textarea id="mediaDescription" placeholder="Description..."></textarea>
                        </div>
                        <button class="submit-btn" id="submitBtn" onclick="submitMedia()">‚úÖ Publier dans la galerie</button>
                    </div>
                </div>

                <div class="admin-gallery">
                    <h3>üóÇÔ∏è Cartes publi√©es</h3>
                    <div class="admin-cards-list" id="adminCardsList">
                        <p style="color:#718096;text-align:center;padding:20px">Aucune carte publi√©e</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let tg = window.Telegram?.WebApp;
        if (tg) { tg.expand(); tg.ready(); }

        let currentFilter = 'Article';
        const bgMusic = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicBtn');
        let isMusicPlaying = false, musicStarted = false;
        let currentTab = 'file';
        let selectedFile = null;
        let jwtToken = null; // Token JWT stock√© apr√®s login

        // ‚îÄ‚îÄ‚îÄ Musique ‚îÄ‚îÄ‚îÄ
        function startMusicOnInteraction() {
            if (!musicStarted) {
                musicStarted = true;
                bgMusic.play().then(() => { musicBtn.textContent='üîä'; musicBtn.classList.add('playing'); isMusicPlaying=true; }).catch(()=>{});
                document.removeEventListener('click', startMusicOnInteraction);
                document.removeEventListener('touchstart', startMusicOnInteraction);
            }
        }
        document.addEventListener('click', startMusicOnInteraction);
        document.addEventListener('touchstart', startMusicOnInteraction);

        function toggleMusic() {
            if (tg) tg.HapticFeedback.impactOccurred('medium');
            if (isMusicPlaying) { bgMusic.pause(); musicBtn.textContent='üéµ'; musicBtn.classList.remove('playing'); isMusicPlaying=false; }
            else { bgMusic.play().catch(()=>{}); musicBtn.textContent='üîä'; musicBtn.classList.add('playing'); isMusicPlaying=true; }
        }

        // ‚îÄ‚îÄ‚îÄ Admin toggle ‚îÄ‚îÄ‚îÄ
        function toggleAdmin() {
            if (tg) tg.HapticFeedback.impactOccurred('medium');
            const adminView   = document.getElementById('adminView');
            const galleryView = document.getElementById('galleryView');
            const adminBtn    = document.getElementById('adminToggle');
            const headerTitle = document.getElementById('headerTitle');
            if (adminView.classList.contains('active')) {
                adminView.classList.remove('active');
                galleryView.classList.remove('hidden');
                adminBtn.textContent = 'üîê Admin';
                adminBtn.classList.remove('active');
                headerTitle.textContent = 'MA GALERIE';
                loadGallery();
            } else {
                galleryView.classList.add('hidden');
                adminView.classList.add('active');
                adminBtn.textContent = '‚Üê Retour';
                adminBtn.classList.add('active');
                headerTitle.textContent = 'PANEL ADMIN';
                if (jwtToken) {
                    document.getElementById('adminLoginPage').style.display = 'none';
                    document.getElementById('adminPanel').classList.add('active');
                } else {
                    document.getElementById('adminLoginPage').style.display = 'block';
                    document.getElementById('adminPanel').classList.remove('active');
                }
            }
        }

        // ‚îÄ‚îÄ‚îÄ LOGIN ‚Üí appelle /api/admin/login ‚îÄ‚îÄ‚îÄ
        function togglePw() {
            const pw = document.getElementById('adminPassword');
            pw.type = pw.type === 'password' ? 'text' : 'password';
        }

        async function doLogin() {
            if (tg) tg.HapticFeedback.impactOccurred('medium');
            const username = document.getElementById('adminUsername').value.trim();
            const password = document.getElementById('adminPassword').value;
            const err      = document.getElementById('loginError');
            const btn      = document.querySelector('.login-btn');

            if (!username || !password) {
                err.textContent = '‚ùå Remplissez tous les champs';
                err.style.display = 'block'; return;
            }

            btn.textContent = '‚è≥ Connexion...';
            btn.disabled = true;

            try {
                const res = await fetch('/api/admin/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                const data = await res.json();

                if (res.ok && data.token) {
                    jwtToken = data.token;
                    err.style.display = 'none';
                    document.getElementById('loggedUser').textContent = username;
                    document.getElementById('adminLoginPage').style.display = 'none';
                    document.getElementById('adminPanel').classList.add('active');
                    loadAdminCards();
                    if (tg) tg.HapticFeedback.notificationOccurred('success');
                } else {
                    err.textContent = '‚ùå ' + (data.error || 'Identifiants incorrects');
                    err.style.display = 'block';
                    err.style.animation = 'none'; void err.offsetWidth; err.style.animation = 'shake 0.4s ease';
                    if (tg) tg.HapticFeedback.notificationOccurred('error');
                }
            } catch(e) {
                err.textContent = '‚ùå Erreur r√©seau';
                err.style.display = 'block';
            } finally {
                btn.textContent = 'üöÄ Se connecter';
                btn.disabled = false;
            }
        }

        function doLogout() {
            jwtToken = null;
            document.getElementById('adminUsername').value = '';
            document.getElementById('adminPassword').value = '';
            document.getElementById('loginError').style.display = 'none';
            document.getElementById('adminPanel').classList.remove('active');
            document.getElementById('adminLoginPage').style.display = 'block';
        }

        // ‚îÄ‚îÄ‚îÄ Onglets upload ‚îÄ‚îÄ‚îÄ
        function switchTab(tab) {
            currentTab = tab;
            document.getElementById('tabFile').classList.toggle('active', tab === 'file');
            document.getElementById('tabUrl').classList.toggle('active',  tab === 'url');
            document.getElementById('sectionFile').style.display = tab === 'file' ? 'block' : 'none';
            document.getElementById('sectionUrl').style.display  = tab === 'url'  ? 'block' : 'none';
        }

        // ‚îÄ‚îÄ‚îÄ S√©lection fichier ‚îÄ‚îÄ‚îÄ
        function handleFileSelect(e) {
            const file = e.target.files[0];
            if (file) processFile(file);
        }

        function processFile(file) {
            const isVideo = file.type.startsWith('video/');
            const isImage = file.type.startsWith('image/');
            if (!isVideo && !isImage) { alert('‚ùå Format non support√©.'); return; }
            selectedFile = file;
            const sizeMB = (file.size / 1024 / 1024).toFixed(1);
            document.getElementById('previewInfo').textContent = file.name + ' ¬∑ ' + sizeMB + ' MB';
            const preview = document.getElementById('mediaPreview');
            const img     = document.getElementById('previewImg');
            const vid     = document.getElementById('previewVid');
            preview.classList.add('show');
            if (isVideo) {
                vid.src = URL.createObjectURL(file);
                vid.style.display = 'block'; img.style.display = 'none';
                document.getElementById('uploadIcon').textContent = 'üé•';
            } else {
                const reader = new FileReader();
                reader.onload = e2 => { img.src = e2.target.result; img.style.display = 'block'; vid.style.display = 'none'; };
                reader.readAsDataURL(file);
                document.getElementById('uploadIcon').textContent = 'üñºÔ∏è';
            }
        }

        function removeFile() {
            selectedFile = null;
            document.getElementById('fileInput').value = '';
            document.getElementById('mediaPreview').classList.remove('show');
            document.getElementById('previewImg').src = '';
            const vid = document.getElementById('previewVid');
            if (vid.src) URL.revokeObjectURL(vid.src);
            vid.src = '';
            document.getElementById('uploadIcon').textContent = 'üì∏';
            document.getElementById('uploadProgress').classList.remove('show');
            document.getElementById('progressFill').style.width = '0%';
        }

        // ‚îÄ‚îÄ‚îÄ SOUMETTRE ‚Üí /api/admin/upload avec JWT ‚îÄ‚îÄ‚îÄ
        async function submitMedia() {
            if (tg) tg.HapticFeedback.impactOccurred('medium');
            const name        = document.getElementById('mediaName').value.trim();
            const category    = document.getElementById('mediaCategory').value;
            const description = document.getElementById('mediaDescription').value.trim();
            const submitBtn   = document.getElementById('submitBtn');

            if (!name) { alert('‚ùå Le nom est obligatoire.'); return; }
            if (!jwtToken) { alert('‚ùå Session expir√©e, reconnectez-vous.'); doLogout(); return; }

            submitBtn.disabled = true;
            submitBtn.textContent = '‚è≥ Publication...';

            try {
                if (currentTab === 'file') {
                    if (!selectedFile) { alert('‚ùå Choisissez un fichier.'); return; }

                    const formData = new FormData();
                    formData.append('file', selectedFile);
                    formData.append('name', name);
                    formData.append('category', category);
                    formData.append('description', description);

                    const progress = document.getElementById('uploadProgress');
                    const fill     = document.getElementById('progressFill');
                    const label    = document.getElementById('progressLabel');
                    progress.classList.add('show');
                    fill.style.width = '0%';
                    label.textContent = 'Envoi en cours...';

                    await new Promise((resolve, reject) => {
                        const xhr = new XMLHttpRequest();
                        // ‚úÖ Bon endpoint : /api/admin/upload
                        xhr.open('POST', '/api/admin/upload');
                        // ‚úÖ Header Authorization avec JWT
                        xhr.setRequestHeader('Authorization', 'Bearer ' + jwtToken);
                        xhr.upload.onprogress = (e) => {
                            if (e.lengthComputable) {
                                const pct = Math.round((e.loaded / e.total) * 100);
                                fill.style.width = pct + '%';
                                label.textContent = 'Envoi : ' + pct + '%';
                            }
                        };
                        xhr.onload = () => {
                            if (xhr.status >= 200 && xhr.status < 300) {
                                label.textContent = '‚úÖ Publi√© !';
                                fill.style.width = '100%';
                                resolve();
                            } else {
                                let msg = 'Erreur ' + xhr.status;
                                try { msg = JSON.parse(xhr.responseText).error || msg; } catch(e){}
                                reject(new Error(msg));
                            }
                        };
                        xhr.onerror = () => reject(new Error('Erreur r√©seau'));
                        xhr.send(formData);
                    });

                } else {
                    // Mode URL
                    const mediaUrl = document.getElementById('mediaUrl').value.trim();
                    if (!mediaUrl) { alert('‚ùå Entrez une URL.'); return; }
                    const mediaType = /\.(mp4|mov|webm|avi)$/i.test(mediaUrl) ? 'video' : 'image';

                    // Pour le mode URL, on passe par /api/admin/upload aussi
                    // mais on envoie en JSON avec un champ url
                    const res = await fetch('/api/admin/upload', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer ' + jwtToken
                        },
                        body: JSON.stringify({ name, url: mediaUrl, type: mediaType, category, description, fromUrl: true })
                    });
                    if (!res.ok) {
                        const d = await res.json().catch(()=>({error:'Erreur'}));
                        throw new Error(d.error || 'Erreur publication');
                    }
                }

                if (tg) tg.HapticFeedback.notificationOccurred('success');
                alert('‚úÖ Publi√© dans la galerie !');
                document.getElementById('mediaName').value = '';
                document.getElementById('mediaDescription').value = '';
                document.getElementById('mediaUrl').value = '';
                removeFile();
                loadAdminCards();
                loadGallery();

            } catch(e) {
                console.error(e);
                alert('‚ùå √âchec : ' + e.message);
                if (tg) tg.HapticFeedback.notificationOccurred('error');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = '‚úÖ Publier dans la galerie';
            }
        }

        // ‚îÄ‚îÄ‚îÄ LISTE CARTES ADMIN ‚îÄ‚îÄ‚îÄ
        async function loadAdminCards() {
            try {
                const res  = await fetch('/api/media');
                const data = await res.json();
                renderAdminCards(data);
            } catch(e) {}
        }

        function renderAdminCards(media) {
            const list = document.getElementById('adminCardsList');
            if (!media || !media.length) {
                list.innerHTML = '<p style="color:#718096;text-align:center;padding:20px">Aucune carte publi√©e</p>';
                return;
            }
            list.innerHTML = media.map(item => {
                const thumb = item.type === 'video'
                    ? `<div class="admin-card-thumb" style="display:flex;align-items:center;justify-content:center;font-size:26px;background:#edf2f7;border-radius:10px;">üé•</div>`
                    : `<img class="admin-card-thumb" src="${item.url}" onerror="this.style.background='#edf2f7';this.src=''">`;
                return `<div class="admin-card-item">
                    ${thumb}
                    <div class="admin-card-info">
                        <div class="admin-card-name">${item.name}</div>
                        <div class="admin-card-cat">${item.category} ¬∑ ${item.type}</div>
                    </div>
                    <button class="delete-btn" onclick="deleteCard('${item.id}')">üóëÔ∏è</button>
                </div>`;
            }).join('');
        }

        async function deleteCard(id) {
            if (!confirm('Supprimer cette carte ?')) return;
            if (!jwtToken) { alert('‚ùå Session expir√©e.'); doLogout(); return; }
            try {
                // ‚úÖ Bon endpoint : /api/admin/media/:id avec JWT
                const res = await fetch('/api/admin/media/' + id, {
                    method: 'DELETE',
                    headers: { 'Authorization': 'Bearer ' + jwtToken }
                });
                if (res.ok) { loadAdminCards(); loadGallery(); }
                else alert('‚ùå Impossible de supprimer.');
            } catch(e) { alert('‚ùå Erreur r√©seau.'); }
        }

        // ‚îÄ‚îÄ‚îÄ FILTRES ‚îÄ‚îÄ‚îÄ
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                if (tg) tg.HapticFeedback.impactOccurred('light');
                const filter = this.getAttribute('data-filter');
                currentFilter = filter;
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                const gallery     = document.getElementById('gallery');
                const infoPage    = document.getElementById('infoPage');
                const contactPage = document.getElementById('contactPage');
                gallery.style.display     = 'none';
                infoPage.style.display    = 'none';
                contactPage.style.display = 'none';
                if (filter === 'Info')         infoPage.style.display    = 'block';
                else if (filter === 'Contact') contactPage.style.display = 'block';
                else { gallery.style.display = 'grid'; loadGallery(); }
            });
        });

        // ‚îÄ‚îÄ‚îÄ GALERIE ‚îÄ‚îÄ‚îÄ
        async function loadGallery() {
            try {
                const res  = await fetch('/api/media');
                const data = await res.json();
                renderGallery(data);
            } catch(e) {
                document.getElementById('gallery').innerHTML = `
                    <div class="empty-state"><div class="empty-icon">üì≠</div>
                    <h3>Aucun contenu</h3><p>La galerie est vide</p></div>`;
            }
        }

        function renderGallery(media) {
            const gallery  = document.getElementById('gallery');
            const filtered = media.filter(m => m.category === currentFilter);
            window._cards  = filtered;
            if (!filtered.length) {
                gallery.innerHTML = `<div class="empty-state"><div class="empty-icon">üì≠</div>
                    <h3>Aucun contenu</h3><p>Aucun m√©dia dans ${currentFilter}</p></div>`;
                return;
            }
            gallery.innerHTML = filtered.map((item, i) => `
                <div class="card" onclick="openCardModal(${i})">
                    <div class="card-media-container">
                        ${item.type === 'video'
                            ? `<video class="card-media" src="${item.url}" playsinline></video><div class="video-icon">‚ñ∂Ô∏è</div>`
                            : `<img class="card-media" src="${item.url}" alt="${item.name}">`}
                        <div class="card-overlay"></div>
                    </div>
                    <div class="card-content">
                        <div class="card-category ${item.category.toLowerCase()}">${item.category}</div>
                        <h3 class="card-title">${item.name}</h3>
                        ${item.description ? `<p class="card-description">${item.description}</p>` : ''}
                    </div>
                </div>`).join('');
        }

        // ‚îÄ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ‚îÄ
        function openCardModal(i) {
            if (tg) tg.HapticFeedback.impactOccurred('medium');
            const item = window._cards[i];
            if (!item) return;
            const media = item.type === 'video'
                ? `<video class="modal-media" src="${item.url}" controls autoplay playsinline></video>`
                : `<img class="modal-media" src="${item.url}" alt="${item.name}">`;
            document.getElementById('modalContent').innerHTML = `${media}
                <div class="modal-body">
                    <div class="modal-category">${item.category}</div>
                    <h2 class="modal-title">${item.name}</h2>
                    ${item.description ? `<p class="modal-desc">${item.description}</p>` : ''}
                </div>`;
            document.getElementById('cardModal').classList.add('open');
            document.body.style.overflow = 'hidden';
        }
        function closeCardModal() {
            document.getElementById('cardModal').classList.remove('open');
            document.body.style.overflow = '';
            const v = document.querySelector('#modalContent video');
            if (v) v.pause();
        }
        function closeModalBg(e) { if (e.target === document.getElementById('cardModal')) closeCardModal(); }
        document.addEventListener('keydown', e => { if (e.key === 'Escape') closeCardModal(); });

        loadGallery();
        setInterval(loadGallery, 30000);
    </script>
</body>
</html>
